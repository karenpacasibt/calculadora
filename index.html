<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <title>Calculadora con Historial</title>
    <link rel="stylesheet" href="styles.css">
</head>

<body>

    <div class="container">
        <div class="calculator">
            <input type="text" class="display" id="display" value="0">
            <div class="buttons">
                <button value="7">7</button>
                <button value="8">8</button>
                <button value="9">9</button>
                <button>+</button>

                <button value="4">4</button>
                <button value="5">5</button>
                <button value="6">6</button>
                <button>-</button>

                <button value="1">1</button>
                <button value="2">2</button>
                <button value="3">3</button>
                <button>x</button>

                <button value=".">.</button>
                <button value="0">0</button>
                <button>⌫</button>
                <button>/</button>

                <button>^</button>
                <button>√</button>
                <button class="clear">CE</button>
                <button class="equals">=</button>
            </div>
        </div>

        <div class="history">
            <h2>Historial Operaciones</h2>
            <ul id="historyList"> 
            </ul>
        </div>
    </div>
    <script>
        const display = document.getElementById('display');
        const buttons = document.querySelectorAll('.buttons button');
        const historyList = document.getElementById('historyList');

        let currentInput = '';
        let operator = '';
        let firstNumber = null;
        function sumar(a, b) {
            return a + b;
        }
        function restar(a, b) {
            return a - b;
        }
        function multiplicar(a, b) {
            return a * b;
        }
        function dividir(a, b) {
            return a / b;
        }
        function potencia(a, b) {
            return Math.pow(a, b);
        }
        function raiz(a) {
            return Math.sqrt(a);
        }
        const operaciones = {
            '+': sumar,
            '-': restar,
            'x': multiplicar,
            '/': dividir,
            '^': potencia,
        }
        function actualizarDisplay(valor) {
            display.value = valor;
        }

        function agregarAHistorial(texto) {
            const li = document.createElement('li');
            li.textContent = texto;
            historyList.appendChild(li);
        }
        for (const button of buttons) {
            button.addEventListener('click', manejarClick);
        }
        function manejarClick(evento) {
            let value = evento.target.textContent;

            if (!isNaN(value) || value === '.') {
                currentInput += value;
                actualizarDisplay(currentInput);
            }
            else if (value in operaciones) {
                operator = value;
                firstNumber = parseFloat(currentInput);
                currentInput = '';
            }
            else if (value === '√') {
                var result = raiz(parseFloat(currentInput));
                actualizarDisplay(result);
                agregarAHistorial('√' + currentInput + ' = ' + result);
                currentInput = result.toString();
            }
            else if (value === '⌫') {
                currentInput = currentInput.slice(0, -1);
                actualizarDisplay(currentInput || '0');
            }

            else if (value === 'CE') {
                currentInput = '';
                firstNumber = null;
                operator = '';
                actualizarDisplay('0');
            }

            else if (value === '=') {
                if (firstNumber !== null && currentInput !== '') {
                    var secondNumber = parseFloat(currentInput);
                    var operacion = operaciones[operator];
                    var resultado = operacion ? operacion(firstNumber, secondNumber) : 'Error';

                    actualizarDisplay(resultado);
                    agregarAHistorial(firstNumber + ' ' + operator + ' ' + secondNumber + ' = ' + resultado);

                    currentInput = resultado.toString();
                    firstNumber = null;
                    operator = '';
                }
            }
        }
    </script>
</body>

</html>